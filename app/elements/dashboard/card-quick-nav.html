<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="../search/field-search.html">

<link id="bible-reference-parser" rel="import" href="../utils/bible-reference-parser.html">

<dom-module id="card-quick-nav">
  <template>
    <style include="shared-styles"></style>
    <style>
      :host{
        display: block;
      }
      paper-card {
        display: block;
      }
      #card .card-content{
        padding-top: 0px;
        margin-top: -20px;
      }
      field-search{
        box-shadow: none;
        border: 0px;
        background: transparent;
        margin: 15px 0px 0px 0px;
        --field-search-input: {
          border-bottom: 1px solid gray;
          padding: 0px 0px 5px 0px;
          font-size: 16px;
        };
      }
    </style>

    <paper-card id="card" heading="Quick Navigation">
      <div class="card-content">
        <field-search class="paper-input-input" label="Enter a bible reference, topic or search term and hit enter..." size="small"></field-search>
        <!--<paper-input error-message="Reference not recognized, format should be like `Mt 1:1` or `Matthew 1:1`" invalid="{{invalid}}" label="Enter a bible reference, topic or search term and hit enter..." on-keyup="checkForEnter"></paper-input>-->
      </div>
    </paper-card>

  </template>

  <script>
    (function() {
      'use strict';

      //var BibleReferencePromise = new Promise(function(resolve, reject) {
        //require(['/elements/utils/bible-reference-parser.js'], resolve, reject);
      //});

      var BibleReference = require('bible-reference-parser');

      Polymer({
        is: 'card-quick-nav',
        ready: function(){

        },
        checkForEnter: function(ev){
          this.invalid = false;
          if(ev.keyCode == 13){
            ev.target.blur();
            app.navigateTo('/search/'+encodeURIComponent(ev.target.value), ev);
            //var reference = new BibleReference(ev.target.value);
           // if(reference.book){
           //   ev.target.blur();
           //   app.navigateTo('/book/'+reference.toString(), ev);
           // }else{
           //   app.navigateTo('/search/'+encodeURIComponent(ev.target.value), ev);

              //this.invalid = true;
            //}
          }
        }
      });

    })();
  </script>

</dom-module>
